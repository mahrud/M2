-- Copyright 2020 by Mahrud Sayrafi

use arithmetic;
use common;
use util;
use expr;

-----------------------------------------------------------------------------
-- C++ interface functions defined in std-thread.cpp
-----------------------------------------------------------------------------

--import Tcompute(str:string, n:int):void;
--import Tinitialize(live:bool):void;

threadLocal export myN := int(0);
setupvarThread("myN", toExpr(myN));

-----------------------------------------------------------------------------
-- Local utilities
-----------------------------------------------------------------------------

-----------------------------------------------------------------------------
-- Exported Functions
-----------------------------------------------------------------------------

myprint(e:Expr):Expr := (
--    Tinitialize(false);
    when e is text:stringCell do (
	myN = myN + 1;
--	Tcompute(text.v, myN);
	toExpr(myN))
    else WrongArgString(1));
setupfun("myprint", myprint).Protected = false; -- will be overloaded
